name: Packaging Gates

on:
  schedule:
    - cron: '30 4 * * *'  # 04:30 UTC daily â€” staggered across ecosystem (Brainarr=base)
  push:
    branches: [main]
    paths:
      - '**/*.cs'
      - '**/*.csproj'
      - 'plugin.json'
      - 'manifest.json'
      - 'packaging/**'
      - 'ext/Lidarr.Plugin.Common/**'
  pull_request:
    branches: [main]
    paths:
      - '**/*.cs'
      - '**/*.csproj'
      - 'plugin.json'
      - 'manifest.json'
      - 'packaging/**'
      - 'ext/Lidarr.Plugin.Common/**'
  workflow_dispatch:

concurrency:
  group: packaging-gates-${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  packaging-gates:
    uses: RicherTunes/Lidarr.Plugin.Common/.github/workflows/packaging-gates.yml@da58f3ef5064cf832d3d6a9eed13eb7d4d3d392f
    with:
      common-path: ext/Lidarr.Plugin.Common
      plugin-csproj: Brainarr.Plugin/Brainarr.Plugin.csproj
      manifest-path: plugin.json
      host-assemblies-path: ext/Lidarr-docker/_output/net8.0
      lidarr-docker-version: pr-plugins-3.1.2.4913
