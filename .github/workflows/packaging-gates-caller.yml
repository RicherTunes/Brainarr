# Caller workflow for Common's reusable packaging gates
# Provides: Canonical Abstractions, MAN004 escalation, Entrypoint validation, Parity lint
name: Packaging Gates (Reusable)

on:
  push:
    branches: [main]
    paths:
      - '**/*.cs'
      - '**/*.csproj'
      - 'plugin.json'
      - 'ext/lidarr.plugin.common/**'
  pull_request:
    branches: [main]
    paths:
      - '**/*.cs'
      - '**/*.csproj'
      - 'plugin.json'
      - 'ext/lidarr.plugin.common/**'
  workflow_dispatch:

permissions:
  contents: read

jobs:
  packaging-gates:
    uses: RicherTunes/Lidarr.Plugin.Common/.github/workflows/packaging-gates.yml@1f8bc74
    with:
      common-path: ext/lidarr.plugin.common
      plugin-csproj: Brainarr.Plugin/Brainarr.Plugin.csproj
      manifest-path: plugin.json
    secrets:
      submodules-token: ${{ secrets.SUBMODULES_TOKEN }}
