# Lychee link checker configuration

exclude_path = [
  "**/node_modules/**",
  "**/.git/**",
  "**/TestResults/**",
  # Screenshot PNGs are generated by scripts/snapshots/run-local.sh
  # They may not exist in the repo until CI generates them
  "**/docs/assets/screenshots/*.png"
]

# Ignore common temporary or dynamic links
# Using literal strings (single quotes) for regex patterns to avoid TOML escape issues
exclude = [
  # GitHub compare links (often 404 for forks)
  'https://github.com/.+/(compare|pull)/.+',
  # GitHub wiki placeholder until first page exists
  'https://github.com/.+/.+\.wiki\.git',
  # localhost and private networks
  'http://localhost.*',
  'http://127\.0\.0\.1.*',
  'http://0\.0\.0\.0.*',
  'https?://10\..*',
  'https?://192\.168\..*',
  'https?://172\.(1[6-9]|2[0-9]|3[0-1])\..*',
  # Provider console/API pages that block bots (403)
  'https://platform\.openai\.com.*',
  'https://console\.anthropic\.com.*',
  'https://console\.groq\.com.*',
  'https://platform\.deepseek\.com.*',
  'https://makersuite\.google\.com.*',
  'https://openrouter\.ai.*',
  'https://docs\.perplexity\.ai.*',
  # Screenshot PNGs are generated by CI, not committed to repo
  'file://.*docs/assets/screenshots/.*\.png',
  # Deleted file that still has stale references in templates/tasks
  'file://.*PROVIDER_SUPPORT_MATRIX\.md'
]

# Retry/timeout tuning for flaky docs sites
max_concurrency = 10
retry_wait_time = 2
retry_count = 3
max_redirects = 5

# Treat 429/5xx as retryable and allow some non-standard codes
accept = [200, 201, 202, 203, 204, 206, 226, 300, 301, 302, 303, 304, 307, 308]

# User-Agent to avoid some CDNs blocking default bot UA
user_agent = "Mozilla/5.0 (compatible; Brainarr-Lychee/2.0; +https://github.com/RicherTunes/Brainarr)"

# Cache to speed up and reduce load
cache = true
cache_dir = ".lychee-cache"
cache_timeout = "1d"
