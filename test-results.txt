Test run for I:\Arr-Plugins\Lidarr\Brainarr\Brainarr.Tests\bin\Debug\net6.0\Brainarr.Tests.dll (.NETCoreApp,Version=v6.0)
VSTest version 17.14.1 (x64)

Starting test execution, please wait...
A total of 1 test files matched the specified pattern.
[xUnit.net 00:00:00.86]     Brainarr.Tests.BugFixes.DuplicateRecommendationFixTests.FetchRecommendationsAsync_IntegrationTest_DeduplicatesInWorkflow [SKIP]
  Skipped Brainarr.Tests.BugFixes.DuplicateRecommendationFixTests.FetchRecommendationsAsync_IntegrationTest_DeduplicatesInWorkflow [1 ms]
[xUnit.net 00:00:01.03]     Brainarr.Tests.Services.RateLimiterTests.ExecuteAsync_ConcurrentRequests_MaintainsRateLimit [SKIP]
  Skipped Brainarr.Tests.Services.RateLimiterTests.ExecuteAsync_ConcurrentRequests_MaintainsRateLimit [1 ms]
  Failed Brainarr.Tests.Services.IterativeRecommendationStrategyAdvancedTests.GetIterativeRecommendationsAsync_WithPersistentDuplicates_StopsAfterMaxIterations [1 s]
  Error Message:
   Moq.MockException : 
Expected invocation on the mock exactly 3 times, but was 2 times: p => p.GetRecommendationsAsync(It.IsAny<string>())

Performed invocations:

   Mock<IAIProvider:6> (p):

      IAIProvider.GetRecommendationsAsync("prompt

ðŸ”„ ITERATIVE REQUEST CONTEXT:
â€¢ Requesting 15 recommendations

ðŸ’¡ OPTIMIZATION HINTS:
â€¢ Focus on lesser-known albums by known artists
â€¢ Consider B-sides, live albums, or collaborations
â€¢ Explore different eras of the same artists
")
      IAIProvider.GetRecommendationsAsync("prompt

ðŸ”„ ITERATIVE REQUEST CONTEXT:
â€¢ Requesting 20 recommendations
â€¢ Previously rejected 1 duplicates - avoid these patterns
â€¢ Recent duplicates to avoid: existing artist_existing album

ðŸ’¡ OPTIMIZATION HINTS:
â€¢ Focus on lesser-known albums by known artists
â€¢ Consider B-sides, live albums, or collaborations
â€¢ Explore different eras of the same artists
")

  Stack Trace:
     at Moq.Mock.Verify(Mock mock, LambdaExpression expression, Times times, String failMessage) in /_/src/Moq/Mock.cs:line 332
   at Moq.Mock`1.Verify[TResult](Expression`1 expression, Times times) in /_/src/Moq/Mock`1.cs:line 825
   at Brainarr.Tests.Services.IterativeRecommendationStrategyAdvancedTests.GetIterativeRecommendationsAsync_WithPersistentDuplicates_StopsAfterMaxIterations() in I:\Arr-Plugins\Lidarr\Brainarr\Brainarr.Tests\Services\IterativeRecommendationStrategyAdvancedTests.cs:line 78
--- End of stack trace from previous location ---
